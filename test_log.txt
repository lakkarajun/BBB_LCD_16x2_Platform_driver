* Load the am335x-boneblack.dtb file on Beaglebone Black:

* LCD 16x2 device tree entry details with LCD Platform driver:
* ------------------------------------------------------------
[root@BBB: drivers]# ls /sys/devices/platform/lcd16x2/
driver_override                    supplier:platform:44e10800.pinmux
modalias                           supplier:platform:481ac000.gpio
of_node                            uevent
power                              waiting_for_supplier
subsystem
[root@BBB: lcd16x2]# cat modalias 
of:Nlcd16x2T(null)Corg,lcd16x2
[root@BBB: lcd16x2]# cd of_node
[root@BBB: lcd16x2]# 
[root@BBB: of_node]# ls
compatible     d5-gpios       d7-gpios       name           pinctrl-names  rw-gpios
d4-gpios       d6-gpios       en-gpios       pinctrl-0      rs-gpios       status

* LCD driver module: 
* ------------------
[root@BBB: drivers]# ls
lcd_platform_driver.ko
am335x-boneblack.dtb
[root@BBB: drivers]# insmod lcd_platform_driver.ko
[root@BBB: drivers]# dmesg
[ 5894.848746] lcd_sysfs_init: lcd module load success
[root@BBB: drivers]# lsmod | grep lcd
lcd_platform_driver    12288  0
[root@BBB: drivers]# modinfo lcd_platform_driver.ko 
filename:       /root/drivers/lcd_platform_driver.ko
description:    A LCD gpio sysfs driver
author:         Raju Lakkaraju
license:        GPL
depends:        
name:           lcd_platform_driver
vermagic:       6.15.5 SMP preempt mod_unload modversions ARMv7 p2v8 
[root@BBB: drivers]# rmmod lcd_platform_driver
[root@BBB: drivers]# dmesg
[ 5894.848746] lcd_sysfs_init: lcd module load success
[ 6016.611874] lcd_sysfs_exit: lcd module exit success


* Class entry "bone_lcd" add:
* --------------------------
[root@BBB: drivers]# insmod lcd_platform_driver.ko
[   62.703065] lcd_platform_driver: loading out-of-tree module taints kernel.
[   62.714868] bone-lcd-sysfs lcd16x2: lcd probe success
[   62.726682] lcd_sysfs_init: lcd module load success
[root@BBB: drivers]# dmesg
[   62.703065] lcd_platform_driver: loading out-of-tree module taints kernel.
[   62.714868] bone-lcd-sysfs lcd16x2: lcd probe success
[   62.726682] lcd_sysfs_init: lcd module load success
[root@BBB: drivers]# rmmod lcd_platform_driver
[   92.928803] bone-lcd-sysfs lcd16x2: lcd remove success
[   92.934981] lcd_sysfs_exit: lcd module exit success
[root@BBB: mylcd]# pwd
/sys/class/bone_lcd
[root@BBB: drivers]# cd /sys/class/bone_lcd/
[root@BBB: bone_lcd]# ls

* Class Attributes (lcdcmd, lcdtext, lcdscroll and lcdxy) test:
* -------------------------------------------------------------
Note: lcdcmd, lcdtext and lcdscroll are "Write-Only" attributes
      lcdxy - Read and Write attribute
[root@BBB: drivers]# insmod lcd_platform_driver.ko
[  178.110069] bone-lcd-sysfs lcd16x2: lcd probe success
[  178.120527] lcd_sysfs_init: lcd module load success
[root@BBB: LCD16x2]# lsmod | grep lcd
lcd_platform_driver    12288  0
[root@BBB: LCD16x2]# dmesg
[ 4425.061305] bone-lcd-sysfs lcd16x2: lcd probe success
[ 4425.070589] lcd_sysfs_init: lcd module load success
[root@BBB: LCD16x2]# pwd
/sys/class/bone_lcd/LCD16x2
[root@BBB: LCD16x2]# ls
lcdcmd     lcdscroll  lcdtext    lcdxy      power      subsystem  uevent
[root@BBB: LCD16x2]# cat lcdxy
[root@BBB: LCD16x2]# echo 0x1 > lcdcmd
[root@BBB: drivers]# dmesg
[ 7632.430183] bone_lcd LCD16x2: lcdxy_show:
[ 7648.012395] bone_lcd LCD16x2: lcdcmd_store: count:4
[root@BBB: LCD16x2]# echo "Hello" > lcdtext
[ 7693.344504] bone_lcd LCD16x2: lcdtext_store: count:6
[root@BBB: LCD16x2]# cat lcdtext
cat: can't open 'lcdtext': Permission denied

* Mount debugfs:
* --------------
[root@BBB: ~]# mount -t debugfs none /sys/kernel/debug
[root@BBB: ~]# cat /sys/kernel/debug/pinctrl/44e10800.pinmux-pinctrl-single/pinmux-pins | grep -i lcd
pin 40 (PIN40): lcd16x2 (GPIO UNCLAIMED) function bone_p8_gpios group bone_p8_gpios
pin 41 (PIN41): lcd16x2 (GPIO UNCLAIMED) function bone_p8_gpios group bone_p8_gpios
pin 42 (PIN42): lcd16x2 (GPIO UNCLAIMED) function bone_p8_gpios group bone_p8_gpios
pin 43 (PIN43): lcd16x2 (GPIO UNCLAIMED) function bone_p8_gpios group bone_p8_gpios
pin 44 (PIN44): lcd16x2 (GPIO UNCLAIMED) function bone_p8_gpios group bone_p8_gpios
pin 45 (PIN45): lcd16x2 (GPIO UNCLAIMED) function bone_p8_gpios group bone_p8_gpios
pin 46 (PIN46): lcd16x2 (GPIO UNCLAIMED) function bone_p8_gpios group bone_p8_gpios
[root@BBB: ~]#

[root@BBB: 44e10800.pinmux-pinctrl-single]# cat pingroups
...
group: bone_p8_gpios
pin 40 (PIN40)
pin 41 (PIN41)
pin 42 (PIN42)
pin 43 (PIN43)
pin 44 (PIN44)
pin 45 (PIN45)
pin 46 (PIN46)

[root@BBB: 44e10800.pinmux-pinctrl-single]# ls
gpio-ranges       pingroups         pinmux-functions  pinmux-pins       pinmux-select     pins
[root@BBB: 44e10800.pinmux-pinctrl-single]# cat pins
...
pin 40 (PIN40) 6:gpio-32-63 44e108a0 0000000f pinctrl-single
pin 41 (PIN41) 7:gpio-32-63 44e108a4 0000000f pinctrl-single
pin 42 (PIN42) 8:gpio-32-63 44e108a8 0000000f pinctrl-single
pin 43 (PIN43) 9:gpio-32-63 44e108ac 0000000f pinctrl-single
pin 44 (PIN44) 10:gpio-32-63 44e108b0 0000000f pinctrl-single
pin 45 (PIN45) 11:gpio-32-63 44e108b4 0000000f pinctrl-single
pin 46 (PIN46) 12:gpio-32-63 44e108b8 0000000f pinctrl-single

* Working LCD Commands Test:
* --------------------------
[root@BBB: LCD16x2]# echo 0x1 > lcdcmd
[root@BBB: LCD16x2]# echo -n "Hello Raju" > lcdtext
[root@BBB: LCD16x2]# echo 0x2 > lcdcmd
[root@BBB: LCD16x2]# echo 21 > lcdxy
sh: write error: Bad address
[root@BBB: LCD16x2]# echo -n "Welcome... !!!" > lcdtext
[root@BBB: LCD16x2]# echo on > lcdscroll
[root@BBB: LCD16x2]# echo on > lcdscroll    <-- Left shift the one charecter space
[root@BBB: LCD16x2]# echo off > lcdscroll   <-- Reset the display to actual display
4. Display Control
0x08 – Display OFF, Cursor OFF, Blink OFF       ← **use this to stop blinking**
0x0C – Display ON, Cursor OFF, Blink OFF
0x0E – Display ON, Cursor ON, Blink OFF
0x0D – Display ON, Cursor OFF, Blink ON
0x0F – Display ON, Cursor ON, Blink ON

[root@BBB: ~]# lcdinsmod
[root@BBB: ~]# cdlcdcmds
[root@BBB: LCD16x2]# pwd
/sys/class/bone_lcd/LCD16x2
[root@BBB: LCD16x2]# ls
lcdcmd     lcdscroll  lcdtext    lcdxy      power      subsystem  uevent
[root@BBB: LCD16x2]# echo 0x1 > lcdcmd
[root@BBB: LCD16x2]# echo 0x2 > lcdcmd
[root@BBB: LCD16x2]# echo -n "Good morning !" > lcdtext
[root@BBB: LCD16x2]# echo 21 > lcdxy
[root@BBB: LCD16x2]# echo -n "World" > lcdtext
[root@BBB: LCD16x2]# cat lcdxy
(2, 1)
[root@BBB: LCD16x2]# echo "on" > lcdscroll
[root@BBB: LCD16x2]# echo "on" > lcdscroll
[root@BBB: LCD16x2]# echo "on" > lcdscroll
[root@BBB: LCD16x2]# echo "on" > lcdscroll
[root@BBB: LCD16x2]# echo "on" > lcdscroll
[root@BBB: LCD16x2]# echo "on" > lcdscroll
[root@BBB: LCD16x2]# echo 0x2 > lcdcmd
[root@BBB: LCD16x2]# echo 5 > lcdxy
[ 4264.880161] bone_lcd LCD16x2: invalid input(0, 5), range x:1-2, y:1-16

